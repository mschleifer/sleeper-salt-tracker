import O from"./inputtext.esm.8b1dcb51.js";import q from"./button.esm.79d9684b.js";import{L as H,M as j,q as Q,r as C,G,t as f,v as _,x as o,N as J,O as y,z,P as X,Q as L,R as E,S as M,T as Y,U as Z,B as P,y as $,V as R,W as B}from"./entry.db485a10.js";import"./basecomponent.esm.87b535d2.js";import"./badge.esm.25740afc.js";import"./index.esm.174cf799.js";import"./baseicon.esm.bfa6651b.js";const A="$s";function K(...n){const i=typeof n[n.length-1]=="string"?n.pop():void 0;typeof n[0]!="string"&&n.unshift(i);const[c,a]=n;if(!c||typeof c!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+c);if(a!==void 0&&typeof a!="function")throw new Error("[nuxt] [useState] init must be a function: "+a);const u=A+c,x=Q(),d=H(x.payload.state,u);if(d.value===void 0&&a){const p=a();if(j(p))return x.payload.state[u]=p,p;d.value=p}return d}const ee=()=>K("username",()=>""),I=()=>K("selectedLeague",()=>({league_id:null,name:null,settings:{playoff_start_week:null}})),N={async fetchData(n){const i=await fetch(n);if(!i.ok)throw new Error(`HTTP error! Status: ${i.status}`);return i.json()},async getSeasonNumber(){const n="https://api.sleeper.app/v1/state/nfl";return(await this.fetchData(n)).season},async getUserDetails(n){const i=`https://api.sleeper.app/v1/user/${n}/`;return await this.fetchData(i)},async getLeaguesForUser(n){const i=await this.getSeasonNumber(),c=`https://api.sleeper.app/v1/user/${n}/leagues/nfl/${i}`;return await this.fetchData(c)},async getRosters(n){const i=`https://api.sleeper.app/v1/league/${n}/rosters`;return await this.fetchData(i)},async getUsers(n){const i=`https://api.sleeper.app/v1/league/${n}/users`;return await this.fetchData(i)},async getWeekNumber(){const n="https://api.sleeper.app/v1/state/nfl";return(await this.fetchData(n)).display_week},async getMatchupsForWeek(n,i){const c=`https://api.sleeper.app/v1/league/${n}/matchups/${i}`;return(await this.fetchData(c)).map(u=>({...u,week:i}))}},se={class:"flex flex-col justify-center text-primary-400 gap-2"},te=["onSubmit"],re={class:"flex flex-col gap-2 place-items-center border border-primary-400 rounded-xl p-10 bg-surface-800"},ne=o("label",{for:"username",class:"text-2xl font-semibold text-center"},"Start with your username",-1),ie={class:"relative"},oe=o("i",{class:"pi pi-search absolute top-2/4 -mt-2 left-3 text-surface-600"},null,-1),ae=["for"],le=["id","value"],ce={__name:"LeagueFinder",setup(n){const i=ee(),c=C([]),a=I(),u=C(!1);G(i,async(d,p)=>{u.value=!0,N.getUserDetails(d).then(t=>{N.getLeaguesForUser(t.user_id).then(l=>{c.value=l,u.value=!1})})});async function x(d){i.value=d.target.elements.username.value}return(d,p)=>{const t=O,l=q;return f(),_("div",se,[o("form",{onSubmit:X(x,["prevent"])},[o("div",re,[ne,o("span",ie,[oe,o("i",{class:"pi pi-spin pi-spinner absolute top-2/4 -mt-2 right-3 text-surface-600",style:J({display:y(u)?"inherit":"none"})},null,4),z(t,{id:"username",type:"text",value:y(i),placeholder:"Search","aria-describedby":"username-help",class:"pl-10"},null,8,["value"])]),z(l,{label:"Go",type:"submit"})])],40,te),(f(!0),_(L,null,E(y(c),g=>(f(),_("label",{key:g.league_id,class:M(["text-center border border-primary-400 rounded-xl p-10",{"bg-surface-800":y(a).league_id!==g.league_id,"bg-surface-600":y(a).league_id===g.league_id}]),for:`rb_${g.league_id}`},[Y(o("input",{type:"radio",id:`rb_${g.league_id}`,"onUpdate:modelValue":p[0]||(p[0]=U=>j(a)?a.value=U:null),value:g,class:"invisible absolute"},null,8,le),[[Z,y(a)]]),P(" "+$(g.name),1)],10,ae))),128))])}}},ue=ce,de={class:"text-center"},pe=o("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},null,-1),fe=[pe],_e=o("th",{class:"text-left sticky left-0 h-fit bg-surface-800"},null,-1),he=o("tr",null,[o("th",{class:"text-left sticky left-0 h-fit bg-surface-800"},[P(" Playing as "),o("i",{class:"pi pi-arrow-down",style:{"font-size":".75rem"}})])],-1),ye={class:"p-2 border-r-2 border-surface-600 sticky left-0 h-fit bg-surface-800"},ge=o("td",{class:"p-2 sticky left-0 h-fit bg-surface-800"},[o("div",{class:"border-t-2 border-surface-600 mb-2"}),P(" Avg. Difference ")],-1),we=o("div",{class:"border-t-2 border-surface-600 mb-2"},null,-1),be=o("td",{class:"p-2 sticky left-0 h-fit bg-surface-800"}," Likely Record ",-1),ke={__name:"ScheduleCompareTable",props:{league_id:String,name:String},setup(n){const i=n,c=I(),a=C([]),u=C(!1);G(()=>i.league_id,async(d,p)=>{u.value=!0,await x(d),u.value=!1});async function x(d){try{const p=await N.getWeekNumber(),t=c.value.settings.playoff_week_start,l=Math.min(p,t-1);console.log(`Current NFL Week: ${p}`);const g=await N.getRosters(d),U=await N.getUsers(d),T={};g.forEach(s=>{T[s.roster_id]=s.owner_id});const F={};U.forEach(s=>{F[s.user_id]=s});const k=[];for(let s=1;s<=l;s++)(await N.getMatchupsForWeek(d,s)).forEach(b=>{const v=b.roster_id,r=T[v],e=F[r],D=g.find(V=>V.roster_id===v),W=D.settings.wins||0,S=D.settings.losses||0,w=D.settings.ties||0,h=k.find(V=>V.roster_id===v);h?h.matchups.push({...b,week:s}):k.push({roster_id:v,owner_id:r,user_info:e,matchups:[{...b,week:s}],weeklyComparisons:[],wins:W,losses:S,ties:w})});k.forEach(s=>{k.forEach(r=>{s!==r&&r.matchups.forEach(e=>{const D=e.matchup_id,W=k.find(S=>S!==r&&S.matchups.some(w=>w.matchup_id===D&&w.week===e.week));if(W){const S=W.matchups.find(w=>w.matchup_id===D&&w.week===e.week);if(S){let w;W===s?(w=s.matchups.find(h=>h.week===e.week).points>e.points?"Win":"Loss",s.weeklyComparisons.find(h=>h.roster_id===r.roster_id)||s.weeklyComparisons.push({roster_id:r.roster_id,owner:r.user_info.display_name,schedule:[],totalWins:0,winDifference:0}),s.weeklyComparisons.find(h=>h.roster_id===r.roster_id).schedule.push({week:e.week,opponent:r.user_info.display_name,result:w})):(w=s.matchups.find(h=>h.week===e.week).points>S.points?"Win":"Loss",s.weeklyComparisons.find(h=>h.roster_id===r.roster_id)||s.weeklyComparisons.push({roster_id:r.roster_id,owner:r.user_info.display_name,schedule:[],totalWins:0,winDifference:0}),s.weeklyComparisons.find(h=>h.roster_id===r.roster_id).schedule.push({week:e.week,opponent:W.user_info.display_name,result:w}))}}})}),s.weeklyComparisons.forEach(r=>{const e=r.schedule.reduce((D,W)=>D+(W.result==="Win"?1:0),0);r.totalWins=e,r.winDifference=e-s.wins}),s.avgWinDifference=s.weeklyComparisons.reduce((r,{winDifference:e})=>r+e,0)/s.weeklyComparisons.length;var m=s.weeklyComparisons.map(r=>r.winDifference).sort((r,e)=>r-e),b=Math.floor((m.length-1)/2),v=m.length%2?m[b]:(m[b]+m[b+1])/2;s.medianWins=s.wins+v,console.log("")}),a.value=k}catch(p){console.error("Error:",p)}}return(d,p)=>(f(),_("div",{class:M(["flex flex-col justify-items-center border border-primary-400 rounded-xl p-10 bg-surface-800 bg-tr",{hidden:!n.league_id}])},[o("div",de,"Win Differences for "+$(i.name),1),o("div",{class:M(["text-center",{hidden:!y(u)}])},fe,2),o("div",{class:M(["overflow-x-auto",{hidden:y(u)}])},[o("table",null,[o("thead",null,[o("tr",null,[_e,(f(!0),_(L,null,E(y(a),t=>(f(),_("th",{key:t.roster_id,class:"p-2"},$(t.user_info.display_name),1))),128))]),he]),o("tbody",null,[(f(!0),_(L,null,E(y(a),t=>(f(),_("tr",{key:t.roster_id},[o("td",ye,$(t.user_info.display_name),1),(f(!0),_(L,null,E(y(a),l=>{var g,U,T,F,k,s,m,b,v,r;return f(),_("td",{key:l.roster_id,class:M(["p-2 text-center border-r-2 border-surface-600 last:border-0 text-white",{"bg-rose-600":((g=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:g.winDifference)<-3,"bg-rose-500":((U=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:U.winDifference)===-3,"bg-rose-400":((T=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:T.winDifference)===-2,"bg-rose-300":((F=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:F.winDifference)===-1,"bg-green-600":((k=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:k.winDifference)>3,"bg-green-500":((s=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:s.winDifference)===3,"bg-green-400":((m=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:m.winDifference)===2,"bg-green-300":((b=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:b.winDifference)===1,"bg-gray-500":((v=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:v.winDifference)===0}])},$(((r=l.weeklyComparisons.find(e=>e.roster_id===t.roster_id))==null?void 0:r.winDifference)??"-"),3)}),128))]))),128)),o("tr",null,[ge,(f(!0),_(L,null,E(y(a),t=>(f(),_("td",{key:t.roster_id,class:"text-center p-2"},[we,P(" "+$(parseFloat(t.avgWinDifference).toFixed(2)),1)]))),128))]),o("tr",null,[be,(f(!0),_(L,null,E(y(a),t=>(f(),_("td",{key:t.roster_id,class:"text-center p-2"},$(t.medianWins)+" - "+$(t.wins+t.losses+t.ties-t.medianWins),1))),128))])])])],2)],2))}},me=ke,ve={class:"flex flex-col gap-2 text-primary-400"},Ee={__name:"index",setup(n){const i=I();return(c,a)=>{const u=ue,x=me;return f(),_("div",ve,[z(u),z(x,R(B(y(i))),null,16)])}}};export{Ee as default};
